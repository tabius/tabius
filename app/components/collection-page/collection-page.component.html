<div class="content">

    <!-- Loading indicator -->
    <div *ngIf="!loaded && (indicatorIsAllowed$|async)" class="indicator">
        <div class="message">Загружаем список песен…</div>
        <gt-loading-indicator></gt-loading-indicator>
    </div>

    <!-- Not found block -->
    <gt-resource-not-found *ngIf="notFound" message="Артист не найден"></gt-resource-not-found>

    <!-- Main content block -->
    <div *ngIf="loaded && collectionViewModel">
        <gt-collection-breadcrumb [collection]="collectionViewModel ? collectionViewModel.collection : null"
                                  [showCollectionLink]="false"></gt-collection-breadcrumb>

        <div class="collection-root">
            <div>
                <h1>{{collectionViewModel.displayName}}</h1>

                <img *ngIf="!!collectionViewModel.imgSrc && !hasImageLoadingError"
                     [src]="collectionViewModel.imgSrc"
                     [alt]="collectionViewModel.collection.name"
                     [title]="collectionViewModel.displayName"
                     (error)="hasImageLoadingError = true"
                     class="collection-image"
                />

                <div *ngIf="collectionViewModel.bands.length > 0" class="bands-info">
                    Группы:
                    <div *ngFor="let band of collectionViewModel.bands">
                        <a routerLink="{{getCollectionPageLink(band.mount)}}">{{band.name}}</a>
                    </div>
                </div>

                <gt-song-list [collectionMount]="collectionViewModel.collection.mount"
                              [songs]="collectionViewModel.songs"
                              style="margin-top: 15px;"
                ></gt-song-list>
            </div>
        </div>

        <div class="add-song-block">
            <button *ngIf="!editorIsOpen" class="btn btn-info" (click)="toggleEditor()">Добавить песню</button>
            <gt-user-registration-prompt *ngIf="editorIsOpen && !user" class="register-prompt"></gt-user-registration-prompt>
            <gt-moderator-prompt *ngIf="editorIsOpen && !!user && !canAddSongs" class="has-no-rights-prompt"></gt-moderator-prompt>
            <gt-song-editor *ngIf="editorIsOpen && canAddSongs"
                            (closeRequest)="toggleEditor()"
                            [songId]="-1"
                            [collectionId]="collectionViewModel.collection.id"
                            [initialFocusMode]="'title'"
            ></gt-song-editor>
        </div>

        <div *ngIf="collectionViewModel.listed" class="pg-search-block">
            <a href="https://priceguard.ru/search?g=digital&q={{collectionViewModel.displayName}}"
               title="Поддержать исполнителя и купить его официальный диск."
               target="_blank"
               rel="noopener">
                Поддержать артиста »
            </a>
        </div>
    </div>
</div>
